<!DOCTYPE html>
<html>
<head>
  <title>CSV Book Search</title>
</head>
<body>

<input
  type="text"
  id="search"
  onkeyup="searchList()"
  placeholder="Search books..."
>

<ul id="list"></ul>

<script>
let books = [];

// 1️⃣ Load CSV
fetch("books.csv")
  .then(res => res.text())
  .then(text => {
    const rows = text.trim().split("\n").slice(1);

    books = rows.map(row => {
      // Handle commas inside quotes safely
      const values = row.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);

      return {
        title: values[0],
        category: values[1],
        tags: values[2],
        rating: values[3]
      };
    });

    renderList(books);
  });

// 2️⃣ Render ONLY titles
function renderList(data) {
  const ul = document.getElementById("list");
  ul.innerHTML = "";

  data.forEach(book => {
    const li = document.createElement("li");
    li.textContent = book.title;
    ul.appendChild(li);
  });
}

// 3️⃣ Search by title / category / tags
function searchList() {
  const input = document
    .getElementById("search")
    .value
    .toLowerCase();

  const filtered = books.filter(book =>
    book.title.toLowerCase().includes(input) ||
    book.category.toLowerCase().includes(input) ||
    book.tags.toLowerCase().includes(input)
  );

  renderList(filtered);
}
</script>

</body>
</html>
