<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Category Generator</title>

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='askpage/style.css') }}"
    />
  </head>
  <body>
    <div class="card">
      <h2>ðŸ“š Favorite Book Category</h2>
      <p>Choose a category you like:</p>

      <input
        type="button"
        name="category"
        value="Science Fiction"
        onclick="selectCategory(this)"
      />
      <input
        type="button"
        name="category"
        value="Mystery"
        onclick="selectCategory(this)"
      />
      <input
        type="button"
        name="category"
        value="Romance"
        onclick="selectCategory(this)"
      />
      <input
        type="button"
        name="category"
        value="Fantasy"
        onclick="selectCategory(this)"
      />

      <button class="finishBtn" id="btnFinish" onclick="finish()">
        Finish
      </button>
    </div>

    <script>
      // ******************************************************
      // URL à¸‚à¸­à¸‡ Google Apps Script (à¹ƒà¸ªà¹ˆ Link à¹€à¸”à¸´à¸¡à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸—à¸µà¹ˆà¸™à¸µà¹ˆ)
      const scriptURL =
        "https://script.google.com/macros/s/AKfycbw0HXbCaUjhV1nIw5x3MBZbosdOelH4isIgb2Cht7hU8lCSNtBbUnRvXzKHYx868FI4zg/exec";
      // ******************************************************

      let selectedValue = "";

      function selectCategory(btn) {
        let buttons = document.getElementsByName("category");
        buttons.forEach((b) => b.classList.remove("selected"));
        btn.classList.add("selected");
        selectedValue = btn.value;
      }
      function finish() {
        if (selectedValue === "") {
          alert("Please select a category!");
          return;
        }

        // Create a hidden form to send data to Flask
        const form = document.createElement("form");
        form.method = "POST";
        form.action = "/recommend"; // This matches your @app.route("/recommend")

        const hiddenField = document.createElement("input");
        hiddenField.type = "hidden";
        hiddenField.name = "category"; // This matches request.form["category"]
        hiddenField.value = selectedValue;

        form.appendChild(hiddenField);
        document.body.appendChild(form);
        form.submit(); // This sends the user to the recommendation page
      }
    </script>
  </body>
</html>
